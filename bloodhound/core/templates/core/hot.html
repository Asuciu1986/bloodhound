{% extends 'base.html' %}

{% load humanize %}

{% block title %}What's Hot Today{% endblock %}

{% block content %}
  <div class="panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">
        What's Hot Today
      </h3>
    </div>
    <table class="table" id="products" data-num-pages="{{ products.paginator.num_pages }}">
      <thead>
        <tr>
          <th>Name</th>
          <th class="text-center">Code</th>
          <th class="text-center"><span class="glyphicon glyphicon-euro"></span></th>
          <th class="text-center">Variance</th>
          <th class="text-center"><span class="fa fa-line-chart"></span></th>
          <th class="text-center"><span class="glyphicon glyphicon-time"></span></th>
        </tr>
      </thead>
      <tbody>
        {% for product in products %}
          <tr class="{% if product.price_percentage_variance < 0 %}bg-success{% elif product.price_percentage_variance > 0 %}bg-danger{% endif %}">
            <td>
              <a href="{% url 'product' product.code %}">{{ product.name }}</a>
            </td>
            <td class="text-right" style="white-space: nowrap;">
              <a href="{{ product.url }}" target="_blank">{{ product.code }} <span class="glyphicon glyphicon-new-window" style="font-size: 60%;"></span></a>
            </td>
            <td class="text-right" style="white-space: nowrap;">{{ product.get_current_price_display }}</td>
            <td>{{ product.get_price_percentage_variance_display }}</td>
            <td class="text-right" style="white-space: nowrap;">{{ product.price_changes }}</td>
            <td class="text-right" style="white-space: nowrap;">{{ product.visited_at|naturaltime }}</td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="6" class="empty-result">
              <span class="glyphicon glyphicon-thumbs-down"></span>
              <h4>No discount today.</h4>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% endblock %}